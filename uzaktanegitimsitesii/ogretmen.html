<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uzaktan Eğitim Platformu</title>
  <style>
    /* Yeni eklenen video yönetimi stilleri */

    /* Ödev Stilleri */
    .assignment-section {
      margin: 25px 0;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border: 1px solid #ddd;
    }

    .upload-box {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .upload-box input[type="file"] {
      margin-bottom: 10px;
      width: 100%;
    }

    .upload-box textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      resize: vertical;
      min-height: 80px;
      margin-bottom: 10px;
    }

    .assignment-item {
      background: white;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .assignment-item h5 {
      margin-top: 0;
      color: #333;
    }

    .assignment-meta {
      font-size: 13px;
      color: #666;
      margin: 5px 0;
    }

    .grade-form {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed #ddd;
    }

    .grade-form input {
      width: 60px;
      padding: 5px;
      margin-right: 10px;
    }

    .teacher-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #4CAF50;
      color: white;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 12px;
    }
  .video-management {
  margin: 20px 0;
  padding: 15px;
  background-color: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #dee2e6;
  }

  .video-management h3 {
  margin-top: 0;
  color: #343a40;
  }

  .video-list {
  margin-top: 15px;
  }

  .video-item {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  padding: 10px;
  background-color: white;
  border-radius: 5px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .video-item input {
  flex: 1;
  padding: 8px;
  border: 1px solid #ced4da;
  border-radius: 4px;
  margin-right: 10px;
  }

  .video-actions {
  display: flex;
  gap: 5px;
  }

  .video-actions button {
  padding: 5px 10px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  }

  .add-video-btn {
  background-color: #28a745;
  color: white;
  }

  .add-video-btn:hover {
  background-color: #218838;
  }

  .delete-btn {
  background-color: #dc3545;
  color: white;
  }

  .delete-btn:hover {
  background-color: #c82333;
  }

  .save-btn {
  background-color: #17a2b8;
  color: white;
  }

  .save-btn:hover {
  background-color: #138496;
  }

  .admin-controls {
  margin-top: 20px;
  padding: 10px;
  background-color: #e2e3e5;
  border-radius: 5px;
  }
  </style>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="wallet"
    style="position: fixed; top: 10px; right: 20px; background: gold; padding: 10px 20px; border-radius: 10px;">
    💰 Paran: <span id="coin">0</span>
  </div>
  <div class="container">
    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar">
      <button class="toggle-btn" onclick="toggleSidebar()">☰</button>
      <h2>Üniteler</h2>
      <ul>
        <li><a href="#unit1">Oryantasyon</a></li>
        <li><a href="#unit2">Ünite 1</a></li>
        <li><a href="#unit3">Ünite 2</a></li>
        <li><a href="#unit4">Ünite 3</a></li>
        <li><a href="#unit5">Ünite 4</a></li>
        <li><a href="#unit6">Ünite 5</a></li>
        <li><a href="market.html">🎁 Market</a></li>
        <li><a href="boos.html">🧟 Boos Dövüşü</a></li>
      </ul>
    </nav>

    <!-- İçerik -->
    <div class="main-content" id="main-content">
      <header>
        <h1>Hoş Geldiniz</h1>
        <p>Basit Elektrik Devresi</p>
      </header>

      <main>
        <section id="unit1" class="unit">
          <h2>Oryantasyon</h2>
          <div class="resources">
            <!-- Video Yönetim Bölümü -->
            <div class="video-management">
              <h3>Video Yönetimi</h3>
              <button class="add-video-btn" onclick="addVideo('unit1')">Video Ekle</button>
              <div class="video-list" id="unit1-video-list">
                <!-- Videolar buraya eklenecek -->
              </div>
            </div>

            <div class="progress-container">
              <div class="progress-bar" id="progressBar"></div>
            </div>
            <p>İzleme Yüzdesi: <span id="progress">0%</span></p>
          </div>
        </section>

        <section id="unit2" class="unit">
          <h2>Ünite 1: Elektriğin Kavramları</h2>
          <div class="resources">
            <!-- Video Yönetim Bölümü -->
            <div class="video-management">
              <h3>Video Yönetimi</h3>
              <button class="add-video-btn" onclick="addVideo('unit2')">Video Ekle</button>
              <div class="video-list" id="unit2-video-list">
                <!-- Videolar buraya eklenecek -->
              </div>
            </div>

            <h3>📄 Konu Anlatımı</h3>
            <a href="kaynaklar/bilgisayara_giris.pdf" target="_blank">Elektriğin kavramları</a>

            <h3>📝 Değerlendirme Soruları</h3>
            <section class="assignment-section">
              <h3>📎 Ödev Yönetimi</h3>

              <!-- Ödev Yükleme Formu -->
              <div class="upload-box">
                <h4>Ödevini Yükle</h4>
                <form id="assignment-form">
                  <input type="file" id="assignment-file" accept=".pdf,.doc,.docx,.zip" required>
                  <textarea id="assignment-notes" placeholder="Açıklama ekle..."></textarea>
                  <button type="submit" class="submit-btn">Gönder</button>
                </form>
              </div>

              <!-- Ödev Listesi (Öğrenci Görünümü) -->
              <div class="assignment-list student-view">
                <h4>Gönderdiğin Ödevler</h4>
                <div class="assignments" id="student-assignments">
                  <!-- Dinamik olarak ödevler buraya gelecek -->
                </div>
              </div>

              <!-- Değerlendirme Paneli (Hoca Görünümü) -->
              <div class="assignment-list teacher-view" style="display:none;">
                <h4>Ödev Değerlendirme</h4>
                <div class="assignments" id="teacher-assignments">
                  <!-- Dinamik olarak tüm ödevler buraya gelecek -->
                </div>
              </div>
            </section>
            <h3>Tartışma ve Sorular</h3>
            <form id="discussion-form-unit1">
              <textarea id="question-unit1" placeholder="Sorunuzu yazın..." required></textarea>
              <button type="submit" class="submit-btn">Gönder</button>
            </form>
            <div id="discussion-comments-unit1"></div>
          </div>
        </section>

        <!-- Diğer üniteler aynı şekilde güncellendi -->
        <section id="unit4" class="unit">
          <h2>Ünite 2: Devre Türleri</h2>
          <div class="resources">
            <!-- Video Yönetim Bölümü -->
            <div class="video-management">
              <h3>Video Yönetimi</h3>
              <button class="add-video-btn" onclick="addVideo('unit4')">Video Ekle</button>
              <div class="video-list" id="unit4-video-list">
                <!-- Videolar buraya eklenecek -->
              </div>
            </div>

            <h3>📄 Konu Anlatımı</h3>
            <a href="kaynaklar/bilgisayara_giris.pdf" target="_blank">Devre Türleri</a>

            <h3>📝 Değerlendirme Soruları</h3>
            <section class="assignment-section">
              <h3>📎 Ödev Yönetimi</h3>

              <!-- Ödev Yükleme Formu -->
              <div class="upload-box">
                <h4>Ödevini Yükle</h4>
                <form id="assignment-form">
                  <input type="file" id="assignment-file" accept=".pdf,.doc,.docx,.zip" required>
                  <textarea id="assignment-notes" placeholder="Açıklama ekle..."></textarea>
                  <button type="submit" class="submit-btn">Gönder</button>
                </form>
              </div>

              <!-- Ödev Listesi (Öğrenci Görünümü) -->
              <div class="assignment-list student-view">
                <h4>Gönderdiğin Ödevler</h4>
                <div class="assignments" id="student-assignments">
                  <!-- Dinamik olarak ödevler buraya gelecek -->
                </div>
              </div>

              <!-- Değerlendirme Paneli (Hoca Görünümü) -->
              <div class="assignment-list teacher-view" style="display:none;">
                <h4>Ödev Değerlendirme</h4>
                <div class="assignments" id="teacher-assignments">
                  <!-- Dinamik olarak tüm ödevler buraya gelecek -->
                </div>
              </div>
            </section>
            <h3>Tartışma ve Sorular</h3>
            <form id="discussion-form-unit4">
              <textarea name="question" id="question-unit4" placeholder="Sorunuzu buraya yazın..." required></textarea>
              <button type="submit" class="submit-btn">Gönder</button>
            </form>
            <div id="discussion-comments-unit4"></div>
          </div>
        </section>

        <!-- Chatbot İkonu -->
        <div id="chat-container" class="chat-container">
          <div id="chatbot-icon" class="chatbot-icon" onclick="openChat()">
            🗨️
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    // Video yönetimi fonksiyonları
    function addVideo(unitId) {
      const videoList = document.getElementById(`${unitId}-video-list`);
      const videoItem = document.createElement('div');
      videoItem.className = 'video-item';
      videoItem.innerHTML = `
        <input type="text" placeholder="Video URL'sini girin (YouTube, Vimeo, vb.)">
        <div class="video-actions">
          <button class="save-btn" onclick="saveVideo(this, '${unitId}')">Kaydet</button>
          <button class="delete-btn" onclick="deleteVideo(this, '${unitId}')">Sil</button>
        </div>
      `;
      videoList.appendChild(videoItem);
    }

    function saveVideo(button, unitId) {
      const videoItem = button.closest('.video-item');
      const videoUrl = videoItem.querySelector('input').value.trim();

      if (videoUrl) {
        // Burada video URL'sini kaydedebilirsiniz (localStorage veya sunucuya)
        alert(`Video kaydedildi: ${videoUrl}`);

        // Kaydedilen videoyu görüntülemek için bir iframe oluştur
        const videoDisplay = document.createElement('div');
        videoDisplay.className = 'video-display';
        videoDisplay.innerHTML = `
          <iframe width="560" height="315" src="${embedVideoUrl(videoUrl)}" frameborder="0" allowfullscreen></iframe>
          <button class="delete-btn" onclick="deleteSavedVideo(this, '${unitId}')">Videoyu Sil</button>
        `;

        // Video öğesini değiştir
        videoItem.replaceWith(videoDisplay);

        // Videoları localStorage'a kaydet
        saveVideosToStorage(unitId);
      } else {
        alert('Lütfen geçerli bir video URL\'si girin!');
      }
    }

    function deleteVideo(button, unitId) {
      if (confirm('Bu videoyu silmek istediğinize emin misiniz?')) {
        button.closest('.video-item').remove();
      }
    }

    function deleteSavedVideo(button, unitId) {
      if (confirm('Bu videoyu silmek istediğinize emin misiniz?')) {
        button.closest('.video-display').remove();
        saveVideosToStorage(unitId);
      }
    }

    function embedVideoUrl(url) {
      // YouTube embed URL dönüşümü
      if (url.includes('youtube.com') || url.includes('youtu.be')) {
        const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
        const match = url.match(regExp);
        const videoId = (match && match[2].length === 11) ? match[2] : null;
        return `https://www.youtube.com/embed/${videoId}`;
      }

      // Vimeo embed URL dönüşümü
      if (url.includes('vimeo.com')) {
        const regExp = /^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/;
        const match = url.match(regExp);
        const videoId = match ? match[5] : null;
        return `https://player.vimeo.com/video/${videoId}`;
      }

      return url; // Diğer URL'ler doğrudan kullanılır
    }

    function saveVideosToStorage(unitId) {
      const videoDisplays = document.querySelectorAll(`#${unitId}-video-list .video-display`);
      const videos = Array.from(videoDisplays).map(display => {
        return { url: display.querySelector('iframe').src };
      });

      localStorage.setItem(`videos_${unitId}`, JSON.stringify(videos));
    }

    function loadVideosFromStorage(unitId) {
      const savedVideos = JSON.parse(localStorage.getItem(`videos_${unitId}`)) || [];
      const videoList = document.getElementById(`${unitId}-video-list`);

      savedVideos.forEach(video => {
        const videoDisplay = document.createElement('div');
        videoDisplay.className = 'video-display';
        videoDisplay.innerHTML = `
          <iframe width="560" height="315" src="${video.url}" frameborder="0" allowfullscreen></iframe>
          <button class="delete-btn" onclick="deleteSavedVideo(this, '${unitId}')">Videoyu Sil</button>
        `;
        videoList.appendChild(videoDisplay);
      });
    }

    // Sayfa yüklendiğinde videoları yükle
    document.addEventListener('DOMContentLoaded', () => {
      ['unit1', 'unit2', 'unit4', 'unit5'].forEach(unitId => {
        loadVideosFromStorage(unitId);
      });
    });

    // Mevcut diğer fonksiyonlar...
    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("collapsed");
    }

    function showTab(tabId, btn) {
      const tabs = document.querySelectorAll('.tab-content');
      tabs.forEach(tab => tab.style.display = 'none');

      const buttons = document.querySelectorAll('.tab-button');
      buttons.forEach(b => b.classList.remove('active'));

      document.getElementById(tabId).style.display = 'block';
      btn.classList.add('active');

      const iframe = document.getElementById(tabId).querySelector('iframe');
      if (iframe) {
        const iframeSrc = iframe.src;
        iframe.src = '';
        iframe.src = iframeSrc;
      }
    }

    function openChat() {
      window.open('sohbetadmin.html', '_blank');
    }
    

    // Altın ve video izleme fonksiyonları
    let coin = parseInt(localStorage.getItem("coin")) || 0;
    if (document.getElementById("coin")) {
      document.getElementById("coin").innerText = coin;
    }

    const videos = [
      { id: "video1", watched: false },
      { id: "video2", watched: false },
    ];

    videos.forEach((videoData, index) => {
      const videoElement = document.getElementById(videoData.id);
      if (videoElement) {
        videoElement.addEventListener("ended", () => {
          if (!videoData.watched) {
            videoData.watched = true;
            const rewardKey = `rewardGiven${index}`;
            if (!localStorage.getItem(rewardKey)) {
              coin += 10;
              localStorage.setItem("coin", coin);
              localStorage.setItem(rewardKey, "true");
              if (document.getElementById("coin")) {
                document.getElementById("coin").innerText = coin;
              }
              alert("🎉 Tebrikler! 10 coin kazandın!");
            }
            updateProgress();
          }
        });
      }
    });

    function updateProgress() {
      const watchedCount = videos.filter(v => v.watched).length;
      const percentage = Math.round((watchedCount / videos.length) * 100);
      document.getElementById("progress").innerText = `${percentage}%`;
      document.getElementById("progressBar").style.width = `${percentage}%`;
    }

    // Yorum fonkları
    function loadComments(unitId) {
      const comments = JSON.parse(localStorage.getItem(`${unitId}-comments`)) || [];
      comments.forEach(comment => displayComment(comment, unitId));
    }

    function displayComment(comment, unitId) {
      const commentDiv = document.createElement('div');
      commentDiv.classList.add('comment');
      commentDiv.innerHTML = `<p>${comment.text}</p><button class="delete-btn">Sil</button>`;
      commentDiv.querySelector('.delete-btn').addEventListener('click', function () {
        deleteComment(comment.text, unitId);
        commentDiv.remove();
      });
      document.getElementById(`discussion-comments-${unitId}`).appendChild(commentDiv);
    }

    function deleteComment(commentText, unitId) {
      let comments = JSON.parse(localStorage.getItem(`${unitId}-comments`)) || [];
      comments = comments.filter(comment => comment.text !== commentText);
      localStorage.setItem(`${unitId}-comments`, JSON.stringify(comments));
    }

    function setupCommentForm(unitId) {
      const form = document.getElementById(`discussion-form-${unitId}`);
      if (!form) return;

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const textarea = document.getElementById(`question-${unitId}`);
        const commentText = textarea.value.trim();
        if (commentText) {
          const newComment = { text: commentText };
          const comments = JSON.parse(localStorage.getItem(`${unitId}-comments`)) || [];
          comments.push(newComment);
          localStorage.setItem(`${unitId}-comments`, JSON.stringify(comments));
          displayComment(newComment, unitId);
          form.reset();
        }
      });
    }

    // Tüm üniteler için yorum 
    window.addEventListener('DOMContentLoaded', () => {
      ['unit1', 'unit2', 'unit3', 'unit4', 'unit5'].forEach(unitId => {
        setupCommentForm(unitId);
        loadComments(unitId);
      });
    });
  </script>
  <script>
    (function () {
      if (!window.chatbase || window.chatbase("getState") !== "initialized") {
        window.chatbase = (...arguments) => {
          if (!window.chatbase.q) { window.chatbase.q = [] }
          window.chatbase.q.push(arguments)
        };
        window.chatbase = new Proxy(window.chatbase, {
          get(target, prop) {
            if (prop === "q") { return target.q }
            return (...args) => target(prop, ...args)
          }
        });
      }

      const onLoad = function () {
        const script = document.createElement("script");
        script.src = "https://www.chatbase.co/embed.min.js";
        script.id = "XRca-BGHXUqd6FuJMDdOq";
        script.domain = "www.chatbase.co";
        document.body.appendChild(script);
      };

      if (document.readyState === "complete") {
        onLoad();
      } else {
        window.addEventListener("load", onLoad);
      }
    })();
  </script>
</body>

</html>